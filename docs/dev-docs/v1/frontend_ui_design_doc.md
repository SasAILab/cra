# 合同合规 Agent 系统 - 前端与UI设计师开发文档

## 1. 项目概述

### 1.1 项目背景
合同合规审查系统是一款基于AI技术的合同管理与审查工具，旨在提高合同审查效率、降低合规风险，为法务专员、业务经理和合规经理提供专业的合同处理解决方案。

### 1.2 设计目标
- 构建高性能、可扩展的前端应用
- 实现黑灰色调的高端大气设计风格
- 提供直观、高效的用户界面
- 确保良好的用户体验和无障碍访问

### 1.3 文档目的
本文档旨在为前端开发人员和UI设计师提供全面的开发指南，包括技术架构、设计规范、组件设计、实现细节和协作流程，确保团队成员在统一的标准下开展工作。

## 2. 技术架构与设计规范

### 2.1 技术栈选择

#### 2.1.1 核心技术
- **框架**：React 18 + TypeScript
  - 利用React 18的并发特性提升性能
  - TypeScript提供类型安全保障
- **构建工具**：Vite 4
  - 快速的开发服务器和构建速度
  - 现代前端工具链支持
- **状态管理**：Redux Toolkit + RTK Query
  - Redux Toolkit简化Redux使用
  - RTK Query处理API请求和缓存
- **UI组件库**：Ant Design 5.x
  - 符合黑灰色调设计偏好
  - 丰富的企业级组件
  - 完整的设计系统支持

#### 2.1.2 辅助技术
- **样式方案**：CSS Modules + Styled Components
  - CSS Modules实现组件样式隔离
  - Styled Components实现组件化样式
- **路由管理**：React Router v6
  - 声明式路由配置
  - 嵌套路由支持
- **HTTP客户端**：Axios + 拦截器
  - 统一的HTTP请求管理
  - 拦截器处理认证、错误等
- **代码规范**：ESLint + Prettier + Husky
  - 统一代码风格
  - 提交前检查确保代码质量

### 2.2 架构模式

#### 2.2.1 组件化架构
- **原子设计原则**：将UI拆分为原子、分子、组织、模板和页面五个层级
- **组件复用**：设计可复用的通用组件
- **单一职责**：每个组件只负责一项功能

#### 2.2.2 模块化设计
- **功能模块分离**：按业务功能划分模块
- **按需加载**：实现代码分割和懒加载
- **微前端架构**：支持多团队协作开发

#### 2.2.3 响应式设计
- **桌面优先**：优先优化桌面端体验
- **多设备适配**：支持平板和移动设备
- **断点设计**：定义清晰的响应式断点

### 2.3 开发工具链
- **IDE支持**：VS Code配置、代码片段
- **调试工具**：React DevTools、Redux DevTools
- **性能监控**：React Profiler、Lighthouse
- **测试工具**：Jest、React Testing Library、Cypress

### 2.4 设计系统规范

#### 2.4.1 设计原则
- **专业性**：体现法律行业的专业严谨
- **效率优先**：简化操作流程，提高工作效率
- **可信度**：清晰展示AI分析依据
- **易用性**：直观的界面设计，低学习成本

#### 2.4.2 颜色系统

##### 主色调
- **黑色系**：#000000、#141414、#1F1F1F
  - 用于背景、标题和重要文本
- **灰色系**：#333333、#666666、#999999、#CCCCCC、#F0F0F0
  - 用于文本、边框和辅助元素

##### 功能色
- **蓝色**：#1890FF（合规、安全）
  - 用于成功状态、合规标识
- **橙色**：#FA8C16（警告）
  - 用于中等风险、警告提示
- **红色**：#F5222D（风险）
  - 用于高风险、错误状态
- **绿色**：#52C41A（成功）
  - 用于成功操作、确认状态

##### 中性色
- **白色**：#FFFFFF
  - 用于卡片、弹窗背景
- **浅灰**：#F5F5F5、#FAFAFA
  - 用于页面背景、分隔线

#### 2.4.3 排版系统

##### 字体
- **主字体**：PingFang SC、Microsoft YaHei、sans-serif
- **等宽字体**：Courier New、monospace（用于代码和合同编号）

##### 字号层级
- **H1**：28px（1.75rem）- 页面标题
- **H2**：24px（1.5rem）- 模块标题
- **H3**：20px（1.25rem）- 组件标题
- **H4**：16px（1rem）- 子组件标题
- **正文**：14px（0.875rem）- 主要文本
- **辅助文本**：12px（0.75rem）- 说明、标签

##### 行高
- **标题**：1.2
- **正文**：1.5
- **辅助文本**：1.4

##### 字重
- **Bold**：600（标题、强调文本）
- **Regular**：400（正文、普通文本）

## 3. 用户体验与界面设计

### 3.1 用户角色与需求

#### 3.1.1 法务专员（Primary User）
- **核心需求**：高效审查合同、准确识别风险
- **界面偏好**：专业、清晰的风险展示，便捷的编辑工具
- **工作流程**：上传合同 → AI分析 → 人工复核 → 生成报告

#### 3.1.2 业务经理（Secondary User）
- **核心需求**：快速起草合规合同，减少沟通成本
- **界面偏好**：直观的模板选择，明确的合规提示
- **工作流程**：选择模板 → 输入信息 → AI起草 → 合规检查

#### 3.1.3 合规经理（Tertiary User）
- **核心需求**：全面监控合规风险，生成合规报告
- **界面偏好**：可视化数据展示，详细的合规统计
- **工作流程**：查看仪表板 → 分析风险分布 → 生成报告

### 3.2 核心使用路径

#### 3.2.1 合同审查路径
```
登录系统 → 上传合同 → AI分析 → 风险识别与高亮 → 人工复核 → 审查报告 → 导出结果
```

#### 3.2.2 合同起草路径
```
选择模板 → 输入合同信息 → AI自动起草 → 实时预览 → 人工编辑 → 合规检查 → 生成合同 → 保存/导出
```

#### 3.2.3 合同对比路径
```
选择合同 → 选择版本 → 并排对比 → 差异高亮 → 变更说明 → 确认保存
```

### 3.3 交互设计规范

#### 3.3.1 通用交互模式
- **点击反馈**：所有可点击元素提供明确的点击状态
- **悬停效果**：鼠标悬停时显示详细信息或操作选项
- **加载状态**：所有异步操作显示加载指示器
- **错误提示**：清晰的错误信息和恢复建议

#### 3.3.2 表单交互
- **实时验证**：表单输入时提供实时验证反馈
- **分步表单**：复杂表单采用分步设计
- **自动填充**：支持常用信息自动填充
- **提交状态**：明确的提交进度和结果提示

#### 3.3.3 导航与跳转
- **面包屑导航**：清晰的页面层级关系
- **侧边栏菜单**：固定的主导航菜单
- **标签页**：多文档同时编辑支持
- **快捷操作**：常用功能的快捷访问

## 4. 核心页面模块设计

### 4.1 仪表板模块 (Dashboard Module)

#### 4.1.1 功能需求
- 系统概览和关键指标展示
- 待处理合同提醒
- 风险分布可视化
- 最近活动记录

#### 4.1.2 布局设计
- **顶部导航栏**：系统标题、用户信息、通知中心
- **左侧侧边栏**：主导航菜单
- **主内容区**：
  - 顶部：关键指标概览卡片
  - 中部：风险分布图表和待处理合同
  - 底部：最近活动记录
- **右侧快捷面板**：快捷操作按钮

#### 4.1.3 组件结构
```
Dashboard
├── Header（顶部导航）
├── Sidebar（侧边栏导航）
├── MainContent
│   ├── OverviewSection
│   │   ├── KPICard（指标卡片）
│   │   └── QuickActions（快捷操作）
│   ├── RiskSection
│   │   ├── RiskChart（风险图表）
│   │   └── RiskDistribution（风险分布）
│   └── ActivitySection
│       └── RecentActivity（最近活动）
└── RightPanel（快捷面板）
```

#### 4.1.4 UI设计规范
- **概览卡片**：
  - 尺寸：240px × 120px
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 圆角：8px
  - 阴影：0 2px 8px rgba(0, 0, 0, 0.3)
- **风险图表**：
  - 尺寸：600px × 300px
  - 背景：#141414
  - 边框：1px solid #333333
  - 圆角：8px
- **活动列表**：
  - 行高：48px
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 圆角：8px

### 4.2 合同管理模块 (Contract Management Module)

#### 4.2.1 功能需求
- 合同上传和解析
- 合同列表管理
- 合同状态跟踪
- 版本历史管理

#### 4.2.2 布局设计
- **顶部操作栏**：上传按钮、筛选条件、搜索框
- **主内容区**：
  - 合同列表：卡片式或表格式展示
  - 合同详情：点击卡片后展示详细信息
- **右侧面板**：合同状态统计

#### 4.2.3 组件结构
```
ContractManagement
├── HeaderActions（顶部操作栏）
│   ├── UploadButton（上传按钮）
│   ├── SearchBar（搜索框）
│   └── FilterPanel（筛选面板）
├── ContractListSection
│   ├── ContractList（合同列表）
│   │   └── ContractCard（合同卡片）
│   └── Pagination（分页）
└── StatsPanel（统计面板）
```

#### 4.2.4 UI设计规范
- **合同上传区域**：
  - 尺寸：自适应容器宽度，高度200px
  - 背景：#1F1F1F
  - 边框：2px dashed #666666
  - 圆角：8px
  - 悬停效果：边框颜色变为#1890FF
- **合同卡片**：
  - 尺寸：320px × 200px
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 圆角：8px
  - 阴影：0 2px 8px rgba(0, 0, 0, 0.2)
  - 状态标签：
    - 待审查：橙色 #FA8C16
    - 审查中：蓝色 #1890FF
    - 已通过：绿色 #52C41A
    - 已拒绝：红色 #F5222D

### 4.3 合同审查模块 (Contract Review Module)

#### 4.3.1 功能需求
- 合同内容展示和编辑
- AI风险识别和高亮
- 风险详情面板
- 人工审核确认

#### 4.3.2 布局设计
- **顶部工具栏**：合同信息、操作按钮
- **主内容区**：双栏布局
  - 左侧：合同内容展示和编辑
  - 右侧：风险列表和详情
- **底部操作栏**：审核操作按钮

#### 4.3.3 组件结构
```
ContractReview
├── ContractHeader（合同头部）
│   ├── ContractInfo（合同信息）
│   └── ActionButtons（操作按钮）
├── MainReviewArea
│   ├── ContractViewer（合同查看器）
│   │   ├── ContentDisplay（内容展示）
│   │   └── RiskHighlighter（风险高亮器）
│   └── RiskPanel（风险面板）
│       ├── RiskList（风险列表）
│       └── RiskDetail（风险详情）
└── ReviewFooter（审核底部栏）
    └── ReviewActions（审核操作）
```

#### 4.3.4 UI设计规范
- **双栏布局**：
  - 左侧合同内容区：70%宽度
  - 右侧风险面板：30%宽度
  - 分隔线：1px solid #333333
- **风险高亮**：
  - 高风险：红色背景 #FFF1F0，边框 #FFCCC7
  - 中风险：橙色背景 #FFF7E6，边框 #FFD591
  - 低风险：黄色背景 #FEFFE6，边框 #FFF1B8
- **风险详情面板**：
  - 背景：#141414
  - 边框：1px solid #333333
  - 圆角：8px
  - 内容间距：16px

### 4.4 合同起草模块 (Contract Drafting Module)

#### 4.4.1 功能需求
- 模板选择和参数输入
- AI辅助起草
- 实时预览和编辑
- 合规性检查

#### 4.4.2 布局设计
- **左侧模板面板**：合同模板列表
- **右侧内容区**：
  - 顶部：参数输入表单
  - 中部：实时预览区域
  - 底部：操作按钮

#### 4.4.3 组件结构
```
ContractDrafting
├── TemplatePanel（模板面板）
│   └── TemplateList（模板列表）
├── DraftContentArea
│   ├── ParameterForm（参数表单）
│   ├── PreviewSection
│   │   ├── DraftPreview（起草预览）
│   │   └── ComplianceChecker（合规检查器）
│   └── DraftActions（起草操作）
└── SuggestionPanel（建议面板）
```

#### 4.4.4 UI设计规范
- **模板选择界面**：
  - 模板卡片尺寸：280px × 160px
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 选中状态：边框颜色变为 #1890FF
- **参数表单**：
  - 字段间距：16px
  - 标签宽度：120px
  - 输入框样式：
    - 背景：#1F1F1F
    - 边框：1px solid #333333
    - 圆角：4px
- **实时预览区域**：
  - 背景：#FFFFFF
  - 文本颜色：#000000
  - 边框：1px solid #333333
  - 圆角：8px

### 4.5 合同对比模块 (Contract Comparison Module)

#### 4.5.1 功能需求
- 多版本合同对比
- 差异高亮显示
- 变更说明记录
- 版本切换控制

#### 4.5.2 布局设计
- **顶部版本选择栏**：选择两个对比版本
- **主内容区**：并排对比视图
- **底部操作栏**：保存、导出等操作

#### 4.5.3 组件结构
```
ContractComparison
├── VersionSelectorBar（版本选择栏）
│   ├── VersionPicker（版本选择器）
│   └── CompareOptions（对比选项）
├── ComparisonView
│   ├── SideBySideView（并排视图）
│   │   ├── LeftVersion（左侧版本）
│   │   ├── RightVersion（右侧版本）
│   │   └── DiffHighlighter（差异高亮器）
│   └── ChangeLog（变更日志）
└── ComparisonActions（对比操作）
```

#### 4.5.4 UI设计规范
- **版本选择器**：
  - 下拉菜单样式：
    - 背景：#1F1F1F
    - 边框：1px solid #333333
    - 圆角：4px
- **并排对比视图**：
  - 左右版本各占50%宽度
  - 中间分隔线：1px solid #333333
  - 滚动同步：左右版本同步滚动
- **差异高亮**：
  - 新增内容：绿色背景 #F6FFED，边框 #B7EB8F
  - 修改内容：黄色背景 #FFFBE6，边框 #FFD591
  - 删除内容：红色背景 #FFF2F0，边框 #FFCCC7

## 5. 组件设计规范

### 5.1 原子组件

#### 5.1.1 Button（按钮）
- **类型**：主要按钮、次要按钮、危险按钮、文本按钮
- **尺寸**：大、中、小
- **状态**：默认、悬停、点击、禁用
- **样式**：
  - 主要按钮：背景 #1890FF，文字白色
  - 次要按钮：背景 #1F1F1F，边框 #333333，文字 #FFFFFF
  - 危险按钮：背景 #F5222D，文字白色

#### 5.1.2 Input（输入框）
- **类型**：文本输入、密码输入、文本域
- **状态**：默认、聚焦、禁用、错误
- **样式**：
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 聚焦：边框颜色变为 #1890FF
  - 错误：边框颜色变为 #F5222D

#### 5.1.3 Card（卡片）
- **类型**：基础卡片、带标题卡片、带操作卡片
- **样式**：
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 圆角：8px
  - 阴影：0 2px 8px rgba(0, 0, 0, 0.2)

### 5.2 分子组件

#### 5.2.1 FormItem（表单项）
- **结构**：标签、输入控件、提示信息
- **布局**：水平布局或垂直布局
- **间距**：标签与输入控件间距8px

#### 5.2.2 SearchBar（搜索框）
- **结构**：输入框、搜索按钮、筛选按钮
- **样式**：
  - 输入框背景：#1F1F1F
  - 边框：1px solid #333333
  - 圆角：4px

#### 5.2.3 RiskTag（风险标签）
- **类型**：高风险、中风险、低风险
- **样式**：
  - 高风险：红色 #F5222D
  - 中风险：橙色 #FA8C16
  - 低风险：黄色 #FAAD14
  - 圆角：12px
  - 文字大小：12px

### 5.3 组织组件

#### 5.3.1 Header（头部导航）
- **结构**：logo、系统标题、用户信息、通知中心
- **样式**：
  - 背景：#141414
  - 高度：64px
  - 边框底部：1px solid #333333

#### 5.3.2 Sidebar（侧边栏）
- **结构**：导航菜单、用户信息
- **样式**：
  - 背景：#1F1F1F
  - 宽度：240px
  - 边框右侧：1px solid #333333

#### 5.3.3 Table（表格）
- **样式**：
  - 表头背景：#141414
  - 行背景：#1F1F1F
  - 边框：1px solid #333333
  - 行高：48px

### 5.4 模板组件

#### 5.4.1 PageLayout（页面布局）
- **结构**：Header + Sidebar + MainContent
- **响应式设计**：
  - 桌面端：三栏布局
  - 平板端：侧边栏折叠
  - 移动端：顶部导航，侧边栏抽屉式

#### 5.4.2 Modal（弹窗）
- **类型**：信息弹窗、确认弹窗、表单弹窗
- **样式**：
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 圆角：8px
  - 阴影：0 4px 12px rgba(0, 0, 0, 0.5)

#### 5.4.3 Drawer（抽屉）
- **位置**：左、右、上、下
- **样式**：
  - 背景：#1F1F1F
  - 边框：1px solid #333333
  - 阴影：0 4px 12px rgba(0, 0, 0, 0.5)

## 6. 前端实现细节

### 6.1 合同编辑与对比技术

#### 6.1.1 富文本编辑器实现
- **核心库**：Slate.js
- **自定义节点类型**：
  - 风险节点（RiskNode）：用于标记风险文本
  - 条款节点（ClauseNode）：用于标记合同条款
  - 注释节点（CommentNode）：用于添加审核注释
- **功能支持**：
  - 格式化：加粗、斜体、下划线、编号
  - 撤销/重做：支持多级撤销
  - 复制/粘贴：保持格式和节点类型

#### 6.1.2 大文档处理优化
- **虚拟滚动**：使用 react-window 实现长文档虚拟滚动
- **文档分块**：将大文档分成多个小块，按需加载
- **Web Workers**：将复杂的文档解析和处理移至 Web Workers
- **增量渲染**：只渲染可视区域的内容

#### 6.1.3 差异对比算法
- **核心库**：diff-match-patch
- **优化策略**：
  - 文档分块对比：将文档分成小块进行对比
  - 缓存对比结果：避免重复计算
  - 增量对比：只对比修改的部分

### 6.2 与后端/AI接口交互

#### 6.2.1 API通信层
- **HTTP客户端**：Axios
- **拦截器配置**：
  - 请求拦截器：添加认证信息、请求ID
  - 响应拦截器：统一错误处理、数据格式转换
- **API文档**：使用 Swagger 或 Postman 维护

#### 6.2.2 异步任务处理
- **任务队列**：使用 Redux Toolkit 管理异步任务
- **进度追踪**：实时显示任务处理进度
- **错误重试**：网络错误自动重试机制
- **状态同步**：确保UI状态与后端保持一致

#### 6.2.3 WebSocket集成
- **实时通知**：合同审核状态更新、系统消息
- **心跳机制**：保持长连接稳定性
- **重连策略**：断开连接后自动重连

### 6.3 权限与安全设计

#### 6.3.1 路由级权限
- **实现方式**：React Router + 权限验证高阶组件
- **配置**：路由配置中添加权限要求
- **处理**：无权限时重定向到登录页面或403页面

#### 6.3.2 组件级权限
- **实现方式**：权限验证组件或自定义Hook
- **使用**：根据用户权限决定组件是否渲染

#### 6.3.3 数据级权限
- **实现方式**：后端API过滤 + 前端验证
- **处理**：根据用户角色过滤敏感数据

### 6.4 性能优化策略

#### 6.4.1 加载性能优化
- **代码分割**：按路由和功能模块分割代码
- **懒加载**：
  - 组件懒加载：使用 React.lazy 和 Suspense
  - 图片懒加载：使用 Intersection Observer
- **预加载**：关键资源预加载
- **CDN加速**：静态资源使用CDN分发

#### 6.4.2 运行时性能优化
- **组件优化**：
  - 使用 React.memo 避免不必要的重渲染
  - 使用 useCallback 和 useMemo 缓存函数和计算结果
- **虚拟列表**：大数据列表使用虚拟滚动
- **内存管理**：及时清理无用资源和事件监听

#### 6.4.3 网络性能优化
- **请求合并**：合并多个API请求
- **数据压缩**：响应数据使用 gzip 压缩
- **缓存策略**：合理设置HTTP缓存头
- **预取策略**：预测用户行为，提前获取数据

### 6.5 状态管理设计

#### 6.5.1 全局状态管理
- **Redux Store结构**：
  ```
  store
  ├── auth（认证状态）
  ├── contracts（合同管理）
  ├── review（合同审查）
  ├── draft（合同起草）
  ├── comparison（合同对比）
  └── ui（UI状态）
  ```
- **RTK Query配置**：
  - API切片定义
  - 缓存策略配置
  - 错误处理

#### 6.5.2 本地状态管理
- **React State**：组件内部简单状态
- **Context**：跨组件共享的状态
- **自定义Hooks**：状态逻辑复用
- **状态机**：复杂状态流转管理

## 7. 测试与质量保证

### 7.1 测试策略
- **单元测试**：组件、Hook、工具函数测试
- **集成测试**：页面流程、API集成测试
- **UI测试**：视觉回归、可访问性测试
- **E2E测试**：端到端用户流程测试

### 7.2 测试工具
- **单元测试**：Jest + React Testing Library
- **集成测试**：React Testing Library + MSW
- **UI测试**：Cypress + Percy
- **性能测试**：Lighthouse + React Profiler

### 7.3 质量保证流程
- **代码审查**：所有代码提交前进行代码审查
- **CI/CD集成**：自动运行测试和构建
- **性能监控**：生产环境性能监控
- **用户反馈**：收集用户反馈，持续改进

## 8. 开发与协作流程

### 8.1 前端与UI设计协作
- **设计文件**：Figma或Sketch设计稿
- **设计系统**：统一的设计系统和组件库
- **原型验证**：高保真原型用户测试
- **设计评审**：定期设计评审会议

### 8.2 开发工作流程
- **需求分析**：理解业务需求和设计要求
- **技术设计**：制定技术实现方案
- **编码实现**：按照设计规范实现功能
- **代码审查**：提交代码进行审查
- **测试验证**：编写和运行测试
- **部署上线**：发布到生产环境

### 8.3 版本控制策略
- **Git工作流**：Git Flow或GitHub Flow
- **分支管理**：
  - main：主分支，稳定版本
  - develop：开发分支，集成最新功能
  - feature：功能分支，开发新功能
  - bugfix：修复分支，修复生产bug

## 9. 部署与维护

### 9.1 构建优化
- **Tree Shaking**：移除未使用的代码
- **代码压缩**：JS、CSS、HTML压缩
- **资源优化**：图片、字体资源优化
- **构建分析**：使用Vite构建分析工具

### 9.2 部署策略
- **CI/CD管道**：GitHub Actions或Jenkins
- **环境配置**：开发、测试、预生产、生产
- **自动化部署**：一键部署到各个环境

### 9.3 监控与维护
- **错误监控**：Sentry或Bugsnag
- **性能监控**：Lighthouse CI或New Relic
- **日志管理**：ELK Stack或Graylog
- **定期维护**：系统更新、性能优化、安全补丁

---

## 附录

### A. 设计资源
- Figma设计文件链接
- 设计系统文档
- 图标库

### B. 开发资源
- 代码仓库链接
- API文档
- 开发环境配置指南

### C. 术语表
- 合同合规：确保合同符合法律法规和企业政策
- AI风险识别：利用人工智能技术识别合同中的风险条款
- RTK Query：Redux Toolkit的API数据获取和缓存工具
- 虚拟滚动：只渲染可视区域内容的优化技术

### D. 版本历史
- v1.0.0：初始版本
- v1.1.0：添加合同对比功能
- v1.2.0：优化性能和用户体验